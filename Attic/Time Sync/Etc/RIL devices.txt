        static size_t countDevices() {
            size_t devices = 0;
            DEVMGR_DEVICE_INFORMATION device;
            
            HANDLE search = FindFirstDevice(DeviceSearchByDeviceName,
                TEXT("RIL*"), &device);

            if (search == INVALID_HANDLE_VALUE) {
                Exception::throwLastError();
            }
            
            do {
                ++devices;
            }
            while (FindNextDevice(search, &device));

            // Don't check for success or failure, doesn't seem to work.
            FindClose(search);

            return devices;
        }
